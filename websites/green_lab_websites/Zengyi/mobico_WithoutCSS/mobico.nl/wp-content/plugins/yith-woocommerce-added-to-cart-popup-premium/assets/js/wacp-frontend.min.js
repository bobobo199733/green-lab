jQuery(document).ready((function(t) {
    "use strict";
    if ("undefined" != typeof yith_wacp) {
        var e, a = t("#yith-wacp-popup"),
            n = a.find(".yith-wacp-overlay"),
            i = a.find(".yith-wacp-close"),
            c = void 0,
            o = function() {
                t("html").removeClass("yith_wacp_open"), a.removeClass("open mini_cart"), setTimeout((function() {
                    e.destroy()
                }), 1e3), t(document).trigger("yith_wacp_popup_after_closing")
            },
            r = function() {
                var e = a.find(".yith-wacp-wrapper"),
                    n = t(window).width(),
                    i = t(window).height(),
                    c = n - 60 > yith_wacp.popup_size.width ? yith_wacp.popup_size.width : n - 60,
                    o = i - 120 > yith_wacp.popup_size.height ? yith_wacp.popup_size.height : i - 120;
                e.css({
                    left: n / 2 - c / 2,
                    top: i / 2 - o / 2,
                    width: c + "px",
                    height: o + "px"
                })
            },
            p = function() {
                var e = t("#yith-wacp-mini-cart"),
                    a = t(window).width(),
                    n = t(window).height() * (yith_wacp.mini_cart_position.top / 100) - e.innerHeight(),
                    i = a * (yith_wacp.mini_cart_position.left / 100) - e.innerWidth();
                e.css({
                    left: i,
                    top: n
                }).show()
            },
            d = function(n) {
                var i = a.find(".yith-wacp-content");
                return void 0 !== n && i.html(n), a.hasClass("open") ? ("undefined" != typeof PerfectScrollbar && e.update(), i.scrollTop(0), t(document).trigger("yith_wacp_popup_changed", [a])) : (t(document).trigger("yith_wacp_popup_before_opening", [a]), r(), "undefined" != typeof PerfectScrollbar && (e = new PerfectScrollbar(".yith-wacp-content", {
                    suppressScrollX: !0
                })), yith_wacp.is_mobile && t("html").addClass("yith_wacp_open"), a.addClass("open"), t(document).trigger("yith_wacp_popup_after_opening", [a])), yith_wacp.touchstart_on_popup_actions_buttons && t(document).on("touchstart", ".popup-actions a", (function() {
                    var e = t(this);
                    e.hasClass("continue-shopping") ? o() : window.location.href = e.attr("href")
                })), yith_wacp.touchstart_on_suggested_products && t(document).on("touchstart", ".yith-wacp-related-product > a", (function() {
                    var e = t(this);
                    window.location.href = e.attr("href")
                })), !1
            },
            _ = function() {
                void 0 !== c && (a.addClass("mini_cart"), d(c))
            },
            s = function(e) {
                e > 0 ? t("#yith-wacp-mini-cart").removeClass("empty") : t("#yith-wacp-mini-cart").addClass("empty"), t(".yith-wacp-mini-cart-count").length && t(".yith-wacp-mini-cart-count").html(e), t(document).trigger("yith_wacp_cart_counter_updated")
            },
            h = function(e) {
                void 0 !== t.fn.block && e.block({
                    message: null,
                    overlayCSS: {
                        background: "#fff url(" + yith_wacp.loader + ") no-repeat center",
                        opacity: .5,
                        cursor: "none"
                    }
                })
            },
            u = function(e, a, n) {
                t(document).trigger("yith_wacp_adding_cart_single"), n.addClass("loading").removeClass("added"), t.ajax({
                    url: window.location,
                    data: e,
                    contentType: !1,
                    processData: !1,
                    dataType: "json",
                    type: "POST",
                    success: function(e) {
                        void 0 !== e.error ? (a.parents("div.product").before(e.error), t("body, html").animate({
                            scrollTop: 0
                        }, 500), a.find(".gfield input, .gfield textarea, .gfield select ").each((function() {
                            t(this).val() || t(this).closest(".gfield").addClass("gfield_error")
                        }))) : void 0 !== e.html ? (d(e.html), c = e.cart_html, t(document.body).trigger("wc_fragment_refresh").trigger("wacp_single_added_to_cart"), s(e.items)) : t(document.body).trigger("added_to_cart", [e.fragments, e.cart_hash, n])
                    },
                    complete: function() {
                        n.removeAttr("disabled").removeClass("loading").addClass("added")
                    }
                })
            };
        if (t("body").on("added_to_cart cleverswatch_after_add_to_cart", (function(t, e, n, i) {
                void 0 === e && (e = JSON.parse(JSON.stringify(sessionStorage.getItem(wc_cart_fragments_params.fragment_name)))), void 0 !== e.yith_wacp_message && (yith_wacp.allow_automatic_popup && d(a.hasClass("mini_cart") ? e.yith_wacp_message_cart : e.yith_wacp_message), c = e.yith_wacp_message_cart, s(e.yith_wacp_cart_items))
            })), t(document).on("yith_wwraq_added_successfully", (function(t, e) {
                void 0 !== e.yith_wacp_raq && d(e.yith_wacp_raq)
            })), a.on("click", ".yith-wacp-remove-cart, .item-remove a.remove", (function(e) {
                e.preventDefault();
                var n = t(this),
                    i = n.data("item_key") ? n.data("item_key") : function(t, e) {
                        var a, n, i = t.split("&");
                        for (n = 0; n < i.length; n++)
                            if ((a = i[n].split("="))[0] === e) return void 0 === a[1] || a[1]
                    }(n.attr("href"), "remove_item"),
                    r = {
                        action: yith_wacp.actionRemove,
                        item_key: i,
                        context: "frontend"
                    };
                h(n.parents("table")), t.ajax({
                    url: yith_wacp.ajaxurl.toString().replace("%%endpoint%%", yith_wacp.actionRemove),
                    data: r,
                    dataType: "json",
                    success: function(e) {
                        "" != e.html ? (a.find(".yith-wacp-content").html(e.html), t(document).trigger("yith_wacp_popup_changed", [a]), t(document.body).trigger("wc_fragment_refresh")) : (t(document.body).trigger("wc_fragment_refresh"), c = void 0, o()), s(e.items), c = e.html
                    }
                })
            })), t(document).on("keydown", (function(t) {
                27 == t.keyCode && o()
            })), a.on("change", "table.cart-list input.qty", (function(e) {
                e.preventDefault();
                var n = t(this),
                    i = {
                        action: yith_wacp.actionUpdate,
                        item_key: n.attr("name").replace(/\[|\]|qty/gi, ""),
                        qty: n.val(),
                        context: "frontend"
                    };
                h(n.parents("table")), t.ajax({
                    url: yith_wacp.ajaxurl.toString().replace("%%endpoint%%", yith_wacp.actionUpdate),
                    data: i,
                    dataType: "json",
                    success: function(e) {
                        "" != e.html && (a.find(".yith-wacp-content").html(e.html), t(document).trigger("yith_wacp_popup_changed", [a]), t(document.body).trigger("wc_fragment_refresh")), s(e.items), c = e.html
                    }
                })
            })), a.on("click", "a.continue-shopping", (function(e) {
                "#" == t(this).attr("href") && (e.preventDefault(), o())
            })), a.on("submit", "#yith-ywraq-form", (function(e) {
                e.preventDefault();
                var a = t(this).serializeArray();
                a.push({
                    name: "action",
                    value: yith_wacp.actionUpdateRaq
                }, {
                    name: "context",
                    value: "frontend"
                }), t.ajax({
                    url: yith_wacp.ajaxurl.toString().replace("%%endpoint%%", yith_wacp.actionUpdateRaq),
                    data: t.param(a),
                    dataType: "json",
                    type: "POST",
                    success: function(t) {
                        d(t.yith_wacp_raq)
                    }
                })
            })), n.on("click", o), i.on("click", (function(t) {
                t.preventDefault(), o()
            })), t(window).on("resize yith_wacp_popup_changed", r), t(document).on("submit", yith_wacp.form_selectors, (function(e) {
                var a = t(this),
                    n = a.find('button[type="submit"]'),
                    i = a.find('input[name="yith-wacp-is-excluded"]'),
                    c = "is_one_click" == a.find('input[name="_yith_wocc_one_click"]').val(),
                    o = a.find('[name="add-to-cart"]').val();
                if ("undefined" != typeof wc_cart_fragments_params && yith_wacp.enable_single && 1 !== t(this).parents(".product-type-external").length && !n.hasClass("wcsatt-add-to-subscription-button") && !i.length && !c) {
                    e.preventDefault();
                    var r = new FormData;
                    t.each(a.find("input[type='file']"), (function(e, a) {
                        t.each(t(a)[0].files, (function(t, e) {
                            r.append(a.name, e)
                        }))
                    })), t.each(a.serializeArray(), (function(t, e) {
                        r.append(e.name, e.value)
                    })), r.append("context", "frontend"), r.append("action", yith_wacp.actionAdd), r.append("ywacp_is_single", "yes"), r.append("yith_wcmcs_currency", yith_wacp.current_currency), !r.getAll("add-to-cart").length && o && r.append("add-to-cart", o), !r.getAll("product_id").length && o && r.append("product_id", o), u(r, a, n)
                }
            })), t(document).on("yith_wacp_popup_after_opening yith_wacp_popup_changed", (function() {
                void 0 !== t.yith_wccl && void 0 !== t.fn.wc_variation_form && (t(document).find(".variations_form:not(.initialized)").each((function() {
                    t(this).wc_variation_form()
                })), t.yith_wccl()), "undefined" != typeof thb_lazyload && thb_lazyload.update()
            })), t(document.body).on("wc_cart_button_updated", (function(t, e) {
                e.closest("form.cart").length && e.parent().find(".added_to_cart").remove()
            })), t(document).on("submit", ".yith-wfbt-form", (function(e) {
                if (void 0 !== yith_wacp.actionAddFBT) {
                    e.preventDefault();
                    var a = t(this),
                        n = a.find('button[type="submit"]'),
                        i = new FormData,
                        c = a.serializeArray();
                    t.each(c, (function(t, e) {
                        i.append(e.name, e.value)
                    })), i.append("context", "frontend"), i.append("actionAjax", yith_wacp.actionAddFBT), i.append("action", "yith_bought_together"), i.append("_wpnonce", yith_wacp.nonceFBT), u(i, a, n)
                }
            })), void 0 !== yith_wacp.actionUpdateMiniCart && t("#yith-wacp-mini-cart").length) {
            var l = function() {
                h(t("#yith-wacp-mini-cart")), t.ajax({
                    url: yith_wacp.ajaxurl.toString().replace("%%endpoint%%", yith_wacp.actionUpdateMiniCart),
                    data: {
                        action: yith_wacp.actionUpdateMiniCart,
                        context: "frontend"
                    },
                    dataType: "json",
                    cache: !1,
                    success: function(e) {
                        c = e.html, s(e.items), t(document).on("click", yith_wacp.open_popup_selectors, _)
                    },
                    complete: function() {
                        void 0 !== t.fn.block && t("#yith-wacp-mini-cart").unblock()
                    }
                })
            };
            t(window).on("resize", p), p(), l(), t(document).on("ajaxfdoe_added wc_fragment_refresh", l)
        }
    }
}));